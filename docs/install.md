# Установка локальной версии

В первую очередь, нужны:

1. nginx
2. nodejs
3. npm
4. mongodb

## Веб-сервер

Nginx проксирует запросы к node-серверу и отдаёт статику.

Конфиг лежит в репозитории, [nginx.conf](../nginx.conf). Чтобы он заработал, надо сделать симлинк из каталога, в который установлен nginx на каталог с проектом, т.к. [nginx понимает относительные пути в конфиге только от него](http://serverfault.com/a/548332).

В дев-конфиге полностью отключён кеш и он настрое на адрес `ithank.local`. Чтобы он начал резолвиться, в `/etc/hosts` надо `127.0.0.1 ithank.local`.

## Установка зависимостей

Фронденд сайта собирает `gulp`, его имеет смысл ставить глобально.

```bash
$ sudo npm i -g gulp
```

Так же должна быть установлена [mongodb](http://www.mongodb.org/) версии `2.0.6` и добавлено `mongod` в переменную окружения, чтобы работало:

```bash
$ mongod
```

Кроме того, должны быть соответствующие права на запись для каталога `/data/db/`

Для установки зависимостей достаточно выполнить в корне проекта

```bash
$ npm i
```

## Сборка фронтенда

```bash
$ gulp
```

## Запуск и остановка приложения
Для управления приложение предназначены скрипты в `scripts/`. 

1. `./scripts/start` запускает монгу и запускает *или* перезапускает приложение;
2. `./scripts/stop` останавливает всё.

**Внимание:** скрипты надо запускать из корня приложения.

Так уж вышло, что в дев-режиме мы валим весь вывод в консоль, но запускаем приложение в фоне. 

